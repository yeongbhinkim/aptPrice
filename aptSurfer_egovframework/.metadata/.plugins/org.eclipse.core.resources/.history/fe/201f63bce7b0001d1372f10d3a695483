<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dbvalley.premier.scm1.monthlyClose.mapper.MonthlyCloseMapper">

<select id="selectMonthlyCloseList" parameterType="json"
		resultType="json">
			
       SELECT ROWNUM RNO, REGEXP_SUBSTR(ROW_DATA,'[^|]+', 1,1 ) AS DIV_TEXT, TO_CHAR(REGEXP_SUBSTR(ROW_DATA,'[^|]+', 1,2 ), 'FM999,999,999,990.00') AS PRICE, 
              TO_CHAR(REGEXP_SUBSTR(ROW_DATA,'[^|]+', 1,3 ), 'FM999,999,999,990.00') AS VAT_PRICE, TO_CHAR(REGEXP_SUBSTR(ROW_DATA,'[^|]+', 1,4 ), 'FM999,999,999,990.00') AS TOTAL_PRICE
        FROM (
                SELECT DECODE(ROWNUM ,1, NB_DATA, 2, LO_DATA, 3, CL_DATA, 4, PR_DATA) AS ROW_DATA, ROWNUM RN
                FROM (       
                    select ('구매마감(일반)'||'|'||ZPO_NB_AMT ||'|'||ZPO_NB_VAT||'|'||ZPO_NB_TOT||'|') AS NB_DATA,
                           ('구매마감(Local)'||'|'||ZPO_LO_AMT ||'|'||ZPO_LO_VAT||'|'||ZPO_LO_TOT||'|') AS LO_DATA,
                           ('유상마감'||'|'||ZSO_CL_AMT ||'|'||ZSO_CL_VAT||'|'||ZSO_CL_TOT||'|') AS CL_DATA,
                           ('단가소급'||'|'||ZNETPR_AMT ||'|'||ZNETPR_VAT||'|'||ZNETPR_TOT||'|') AS PR_DATA
                    from TSCM_SO_CLOSE_TOTAL
					where seqno = #{SEQNO}
                    )
                      
                CONNECT BY LEVEL <![CDATA[ <= ]]> 4
                  
             )
        ORDER BY RN



	</select>
	
</mapper>