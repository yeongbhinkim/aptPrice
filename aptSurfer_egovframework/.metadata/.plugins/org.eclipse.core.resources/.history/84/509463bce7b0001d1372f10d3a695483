<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dbvalley.premier.scm1.recordPrice.mapper.RecordPriceMapper">

<select id="selectRecordPricelist" parameterType="json"
		resultType="json">

	SELECT ROWNUM RNO, A.*, B.MAKTX
 		, nvl(TO_CHAR(TO_DATE(A.DATAB, 'YYYY-MM-DD') ,'YYYY.MM.DD'),'0000.00.00') DATAB_1
 		, nvl(TO_CHAR(TO_DATE(A.DATBI, 'YYYY-MM-DD') ,'YYYY.MM.DD'),'0000.00.00') DATBI_1
 		, A.KBETR||'.00' KBETR_1
 		, (SELECT DESCR FROM xm070_n 
			WHERE MATERIAL_TYPE = B.MTART 
			AND ROWNUM=1) AS MTARTDESC
	FROM TSCM_INFORECORD_PRICE A,   TSCM_M_MATL_MST_IF B
	WHERE A.MATNR = B.MATNR(+)
	AND B.WERKS(+) = #{WERKS}
	AND A.SEQNO =  #{SEQNO}
	AND A.MATNR LIKE '%'||#{MATNR}||'%'
	</select>
	
</mapper>
