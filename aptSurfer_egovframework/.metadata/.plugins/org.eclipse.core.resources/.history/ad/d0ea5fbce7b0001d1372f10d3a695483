<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dbvalley.premier.scm1.downtimeUpN.mapper.DowntimeUpNMapper">
	<select id="downtimeUpNList" parameterType="json" resultType="json">
       	 SELECT ROWNUM RNO, Z.* FROM (
       	SELECT   A.*,
       		ROUND((TO_DATE(TO_CHAR(NVL(ENDDATE, SYSDATE), 'YYYYMMDDHH24MISS'), 'YYYYMMDDHH24MISS') - TO_DATE(TO_CHAR(STARTDATE, 'YYYYMMDDHH24MISS'), 'YYYYMMDDHH24MISS')) * 24 * 60, 2) BGMIN
           , TO_CHAR(STARTDATE, 'YYYY.MM.DD HH24:MI:SS') AS STARTDATE_1
           , TO_CHAR(ENDDATE, 'YYYY.MM.DD HH24:MI:SS') AS ENDDATE_1
           , TO_CHAR(TO_DATE(RECDATE, 'yyyymmdd'),'yyyy.mm.dd') AS RECDATE_1
	        FROM  V_NONLINE_VEND@DBLK_NMES A
	        WHERE  RECDATE BETWEEN #{BUDAT_FR} AND #{BUDAT_TO}  
	        AND    CUSTCODE = #{LIFNR}
	        AND    PLANTCODE = #{WERKS}
	        AND   NVL(UPPER(ERRORITEMCODE),'*') LIKE '%'||NVL(UPPER(#{MATNR}),NVL(UPPER(ERRORITEMCODE),'*'))||'%'
       ORDER BY RECDATE DESC)Z
	</select>

</mapper>