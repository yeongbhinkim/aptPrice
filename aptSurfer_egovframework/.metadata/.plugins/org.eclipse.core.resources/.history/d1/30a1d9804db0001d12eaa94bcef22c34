package egovframework.aptSurfer.common.service;

import java.util.List;
import javax.servlet.http.HttpServletRequest;
import org.springframework.ui.ModelMap;
import net.sf.json.JSONObject;

/**
 * @Class Name : egovframework.aptSurfer.common.mapper.CommonService
 * @Description :  aptSurfer 공통
 * @Modification Information
 * @ 
 * @ 수정일 		 수정자 		수정내용
 * @ ---------- --------- ------------------------------- 
 * @
 * @ 2023.02.19  KIM 		최초생성
 * @author KIM
 * @since 2023.02.19
 * @version 1.0.0
 * @see
 * copyright (c) KIM.inc All rights reserved.
 */

public interface CommonService {

	/**
	 * 화면
	 * 
	 * @param request
	 * @param model
	 * @return
	 * @throws Exception
	 */
	public String commonView(HttpServletRequest request, ModelMap model) throws Exception;

	/**
	 * 팝업
	 * 
	 * @param request
	 * @param model
	 * @return
	 * @throws Exception
	 */
	public String popupcommonView(HttpServletRequest request, ModelMap model) throws Exception;

	/**
	 * 목록 조회
	 * 
	 * @param param
	 * @return
	 * @throws Exception
	 */
	public List<JSONObject> getCommonList(JSONObject param) throws Exception;

	/**
	 * 정보 조회
	 * 
	 * @param param
	 * @return
	 * @throws Exception
	 */
	public JSONObject getCommonInfo(JSONObject param) throws Exception;

	/**
	 * 저장
	 * 
	 * @param param
	 * @throws Exception
	 */
	public void setCommonInfo(JSONObject param) throws Exception;

	/**
	 * 삭제
	 * 
	 * @param param
	 * @throws Exception
	 */
	public void removeCommonInfo(JSONObject param) throws Exception;

	private void calculatePaging() {
		// 요청페이지의 시작페이지
//(올림(요청페이지/요청페이지에 보여줄 페이지수)-1) * 요청페이지에 보여줄 페이지수+1
		startPage = (int) (Math.ceil(rc.getReqPage() / (double) PAGE_COUNT_PER_PAGE) - 1) * PAGE_COUNT_PER_PAGE + 1;
//요청페이지의 종료페이지
//올림(요청페이지/요청페이지에 보여줄 페이지수) * 요청페이지에 보여줄 페이지수
		endPage = (int) Math.ceil(rc.getReqPage() / (double) PAGE_COUNT_PER_PAGE) * PAGE_COUNT_PER_PAGE;

//최종페이지
//올림(전체레코드수 / 요청페이지에 보여줄 레코드수)
		finalEndPage = (int) Math.ceil(totalRec / (double) rc.getREC_COUNT_PER_PAGE());

//최종페이지가 요청페이지의 종료페이지보다 작으면 최종페이지가 종료페이지가 된다.
		if (finalEndPage < endPage) {
			endPage = finalEndPage;
		}
	}

	public RecordCriteria getRc() {
    return rc;
  }

	public long getTotalRec() {
    return totalRec;
  }

	/**
   * board테이블의 전체레코드수
   * @param totalRec
   */
  public void setTotalRec(long totalRec) {
    this.totalRec = totalRec;
    this.calculatePaging();
  }

	// 시작페이지
	public int getStartPage() {
    return startPage;
  }

	// 종료페이지
	public int getEndPage() {
    return endPage;
  }

	// 최종페이지
	public int getFinalEndPage() {
    return finalEndPage;
  }

	/**
   * 이전페이지
   * 요청페이지의 시작페이지 이전에 보여줄 레코드가 있으면 보이도록
   * @return
   */
  public boolean isPrev() {
    return startPage != 1 ? true : false;
  }

	/**
   * 다음페이지
   * 요청페이지의 종료페이지 다음에 보여줄 레코드가 있으면 보이도록
   * @return
   */
  public boolean isNext() {
    return endPage * rc.getREC_COUNT_PER_PAGE() < totalRec ? true : false;
  }

}
